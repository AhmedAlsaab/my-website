<!DOCTYPE html>
<html lang="en" data-theme="dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© - A1 Language Certification Paper</title>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
		<link rel="icon" href="data:," />
		<style>
	:root {
		--primary: #4a90e2;
		--primary-hover: #357abd;
		--primary-focus: rgba(74, 144, 226, 0.125);
		--tts-padding: 3.5rem;
	}

	html {
		background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
		background-attachment: fixed;
		min-height: 100%;
	}

	body {
		background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
		background-attachment: fixed;
		position: relative;
		overflow-x: hidden;
		min-height: 100vh;
	}

	/* Sparkly effect */
	body::before {
		content: "";
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-image: radial-gradient(circle, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
			radial-gradient(circle, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
			radial-gradient(circle, rgba(255, 255, 255, 0.4) 2px, transparent 2px);
		background-size: 300px 300px, 200px 200px, 400px 400px;
		background-position: 0 0, 50px 50px, 100px 100px;
		animation: sparkle 20s linear infinite;
		pointer-events: none;
		z-index: 0;
	}

	@keyframes sparkle {
		0% {
			opacity: 0.3;
			transform: translateY(0);
		}
		50% {
			opacity: 0.6;
		}
		100% {
			opacity: 0.3;
			transform: translateY(-100px);
		}
	}

	.container {
		position: relative;
		z-index: 1;
		max-width: 1200px;
		margin: 0 auto;
		padding: 2rem 1rem;
	}

	header {
		text-align: center;
		margin-bottom: 3rem;
		padding: 2rem 0;
		overflow: visible;
	}

	.total-time {
		margin-top: 1rem;
		color: rgba(255, 255, 255, 0.9);
		font-size: clamp(1rem, 2vw, 1.2rem);
		display: inline-flex;
		align-items: center;
		gap: 0.5rem;
		background: rgba(255, 255, 255, 0.1);
		padding: 0.5rem 1.5rem;
		border-radius: 0.5rem;
	}

	h1 {
		font-size: clamp(2.5rem, 5vw, 4rem);
		margin-bottom: 1rem;
		margin-top: 0;
		padding-bottom: 0.5rem;
		line-height: 1.2;
		background: linear-gradient(135deg, #ffffff 0%, #a0c4ff 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
		font-weight: 700;
		overflow: visible;
		display: block;
	}

	.random-button {
		margin-top: 1.5rem;
		font-size: clamp(1rem, 2vw, 1.2rem);
		padding: 0.75rem 2rem;
		background: #ffffff;
		border: 2px solid #ffffff;
		color: #1e3c72;
		border-radius: 0.5rem;
		cursor: pointer;
		transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
		font-weight: 600;
	}

	.random-button:hover {
		transform: translateY(-2px);
		box-shadow: 0 5px 20px rgba(255, 255, 255, 0.5);
		background: #f0f7ff;
	}

	.random-button:active {
		transform: translateY(0);
	}

	.current-paper {
		color: rgba(255, 255, 255, 0.9);
		font-size: clamp(0.9rem, 1.5vw, 1.1rem);
		margin-top: 0.5rem;
	}

	.section {
		background: rgba(255, 255, 255, 0.95);
		border-radius: 1rem;
		padding: 2.5rem;
		margin-bottom: 2rem;
		box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
		backdrop-filter: blur(10px);
	}

	.section h2 {
		color: #1e3c72;
		font-size: clamp(1.8rem, 3vw, 2.5rem);
		margin-bottom: 0.5rem;
		border-bottom: 3px solid #4a90e2;
		padding-bottom: 0.5rem;
		display: flex;
		align-items: center;
		justify-content: space-between;
		flex-wrap: wrap;
		gap: 1rem;
	}

	.section-timestamp {
		display: inline-flex;
		align-items: center;
		gap: 0.5rem;
		background: rgba(74, 144, 226, 0.1);
		padding: 0.5rem 1rem;
		border-radius: 0.5rem;
		font-size: clamp(1rem, 2vw, 1.2rem);
		color: #1e3c72;
		font-weight: 600;
		white-space: nowrap;
	}

	.timer-button {
		background: transparent;
		border: none;
		padding: 0;
		font-size: clamp(1rem, 2vw, 1.2rem);
		cursor: pointer;
		transition: opacity 0.2s;
		color: #1e3c72;
		font-weight: 600;
		line-height: 1;
	}

	.timer-button:hover {
		opacity: 0.7;
	}

	.timer-display {
		font-size: clamp(1rem, 2vw, 1.2rem);
		min-width: 3.5rem;
		text-align: center;
	}

	.timer-running {
		color: #e65100;
	}

	.section-subtitle {
		color: #555;
		font-size: clamp(1rem, 2vw, 1.2rem);
		margin-bottom: 2rem;
		font-style: italic;
	}

	.arabic-text {
		direction: rtl;
		text-align: left;
		font-family: "Segoe UI", Tahoma, Arial, sans-serif;
	}

	.section h2 .arabic-text {
		direction: rtl;
		text-align: left;
	}

	.question-item,
	.situation-item {
		background: rgba(74, 144, 226, 0.08);
		padding: 1.5rem;
		padding-right: var(--tts-padding);
		margin-bottom: 1rem;
		border-radius: 0.5rem;
		border-left: 4px solid #4a90e2;
		position: relative;
	}

	.tts-button {
		position: absolute;
		top: 0.75rem;
		right: 0.75rem;
		background: rgba(74, 144, 226, 0.85);
		border: none;
		border-radius: 50%;
		width: 2rem;
		height: 2rem;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		transition: all 0.2s;
		font-size: 0.9rem;
		box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
		z-index: 10;
	}

	.tts-button:hover {
		background: rgba(74, 144, 226, 1);
		transform: scale(1.1);
		box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
	}

	.tts-button.playing {
		background: rgba(74, 144, 226, 1);
		animation: pulse 1.5s ease-in-out infinite;
	}

	.situation-item .tts-button {
		top: 1rem;
		right: 1rem;
	}

	@keyframes pulse {
		0%,
		100% {
			opacity: 1;
		}
		50% {
			opacity: 0.6;
		}
	}

	.question-text,
	.situation-text {
		font-size: clamp(1.1rem, 2vw, 1.3rem);
		color: #1a1a1a;
		margin: 0;
		font-weight: 500;
		word-wrap: break-word;
		overflow-wrap: break-word;
	}

	.subsection-title {
		color: #2a5298;
		font-size: clamp(1.3rem, 2.5vw, 1.6rem);
		margin-top: 2rem;
		margin-bottom: 0.5rem;
		font-weight: 600;
	}

	.subsection-subtitle {
		color: #666;
		font-size: clamp(0.9rem, 1.8vw, 1.1rem);
		margin-bottom: 1.5rem;
		font-style: italic;
	}

	.listening-text {
		background: #f0f7ff;
		padding: 2rem;
		padding-right: var(--tts-padding);
		border-radius: 0.5rem;
		font-size: clamp(1.1rem, 2vw, 1.3rem);
		line-height: 1.8;
		color: #1a1a1a;
		margin-bottom: 2rem;
		border: 2px solid #4a90e2;
		position: relative;
	}

	.question-answer {
		background: rgba(126, 34, 206, 0.08);
		padding: 1.5rem;
		padding-right: var(--tts-padding);
		margin-bottom: 1rem;
		border-radius: 0.5rem;
		border-left: 4px solid #7e22ce;
		position: relative;
	}

	.answer {
		color: #7e22ce;
		font-weight: 600;
		font-size: clamp(1rem, 2vw, 1.2rem);
		margin-top: 0.5rem;
	}

	.role-context {
		background: #fff3e0;
		padding: 0.75rem 1rem;
		border-radius: 0.25rem;
		margin-bottom: 0.75rem;
		font-size: clamp(0.95rem, 1.8vw, 1.1rem);
		color: #e65100;
		font-weight: 500;
		word-wrap: break-word;
		overflow-wrap: break-word;
	}

	.starter-line {
		font-style: italic;
		color: #2a5298;
		font-size: clamp(1rem, 2vw, 1.2rem);
		margin-top: 0.5rem;
		word-wrap: break-word;
		overflow-wrap: break-word;
	}

	.instruction {
		color: #2a5298;
		font-size: clamp(1.1rem, 2vw, 1.3rem);
		font-weight: 500;
	}

	.monologue-topic {
		background: linear-gradient(135deg, #4a90e2 0%, #7e22ce 100%);
		color: white;
		padding: 2rem;
		padding-right: var(--tts-padding);
		border-radius: 0.5rem;
		font-size: clamp(1.3rem, 2.5vw, 1.8rem);
		text-align: center;
		margin-bottom: 2rem;
		font-weight: 600;
		position: relative;
	}

	.exam-image-container {
		display: flex;
		justify-content: center;
		align-items: center;
		margin: 2rem 0;
		padding: 1.5rem;
		background: rgba(255, 255, 255, 0.95);
		border-radius: 0.75rem;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
	}

	.exam-image {
		max-width: 100%;
		height: auto;
		border-radius: 0.5rem;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
		display: block;
		margin: 0 auto;
	}

	@media (max-width: 768px) {
		:root {
			--tts-padding: 3rem;
		}

		.section {
			padding: 1.5rem;
		}

		.section h2 {
			flex-direction: column;
			align-items: flex-start;
			gap: 0.5rem;
		}

		.section-timestamp {
			align-self: flex-end;
		}

		.tts-button {
			width: 1.75rem;
			height: 1.75rem;
			font-size: 0.8rem;
		}

		.exam-image-container {
			padding: 1rem;
			margin: 1.5rem 0;
		}

		.exam-image {
			max-width: 100%;
			width: 100%;
		}
	}
</style>

	</head>
	<body>
		<nav
	class="main-nav"
	style="
		background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
		padding: 0.75rem 0;
		margin-bottom: 2rem;
		border-radius: 0;
		position: sticky;
		top: 0;
		z-index: 100;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
		border-bottom: 2px solid rgba(255, 255, 255, 0.1);
	"
>
	<!-- Desktop Navigation -->
	<div class="nav-container desktop-nav">
		    
		<a
			href="/"
			class="nav-link"
		>
			Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
		</a>
		    
		<a
			href="/about.html"
			class="nav-link nav-link-active"
		>
			Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
		</a>
		    
		<a
			href="/keywords.html"
			class="nav-link"
		>
			ÙƒÙ„Ù…Ø§Øª Ù…Ù‡Ù…Ø©
		</a>
		    
		<a
			href="/reminders.html"
			class="nav-link"
		>
			ØªØ°ÙƒÙŠØ±Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§Ù…ØªØ­Ø§Ù†
		</a>
		    
		<a
			href="/drills.html"
			class="nav-link"
		>
			ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¬Ù…Ù„
		</a>
		
	</div>

	<!-- Mobile Hamburger Button -->
	<button class="mobile-menu-toggle" aria-label="Toggle menu">
		<span></span>
		<span></span>
		<span></span>
	</button>

	<!-- Mobile Navigation Overlay -->
	<div class="mobile-nav-overlay">
		<div class="mobile-nav-content">
			    
			<a
				href="/"
				class="mobile-nav-link"
			>
				Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
			</a>
			    
			<a
				href="/about.html"
				class="mobile-nav-link mobile-nav-link-active"
			>
				Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
			</a>
			    
			<a
				href="/keywords.html"
				class="mobile-nav-link"
			>
				ÙƒÙ„Ù…Ø§Øª Ù…Ù‡Ù…Ø©
			</a>
			    
			<a
				href="/reminders.html"
				class="mobile-nav-link"
			>
				ØªØ°ÙƒÙŠØ±Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§Ù…ØªØ­Ø§Ù†
			</a>
			    
			<a
				href="/drills.html"
				class="mobile-nav-link"
			>
				ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¬Ù…Ù„
			</a>
			
		</div>
	</div>
</nav>
<style>
	/* Desktop Navigation */
	.desktop-nav {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: 2.5rem;
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 1rem;
	}

	.nav-link {
		font-family: "Segoe UI", Tahoma, Arial, sans-serif;
		direction: rtl;
		color: white;
		text-decoration: none;
		font-weight: 600;
		padding: 0.5rem 1.25rem;
		border-radius: 0.5rem;
		transition: all 0.3s ease;
		font-size: 1.1rem;
		position: relative;
		display: inline-block;
	}

	.nav-link:hover {
		background: rgba(255, 255, 255, 0.25) !important;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
	}

	.nav-link-active {
		background: rgba(255, 255, 255, 0.3) !important;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
	}

	.nav-link-active::after {
		content: "";
		position: absolute;
		bottom: 0.25rem;
		left: 50%;
		transform: translateX(-50%);
		width: 60%;
		height: 2px;
		background: rgba(255, 255, 255, 0.8);
		border-radius: 2px;
	}

	/* Mobile Hamburger Button */
	.mobile-menu-toggle {
		display: none;
		flex-direction: column;
		justify-content: space-around;
		width: 2rem;
		height: 2rem;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
		z-index: 101;
		position: absolute;
		right: 1rem;
		top: 50%;
		transform: translateY(-50%);
	}

	.mobile-menu-toggle span {
		width: 2rem;
		height: 3px;
		background: white;
		border-radius: 3px;
		transition: all 0.3s ease;
		transform-origin: center;
	}

	.mobile-menu-toggle.active span:nth-child(1) {
		transform: rotate(45deg) translate(8px, 8px);
	}

	.mobile-menu-toggle.active span:nth-child(2) {
		opacity: 0;
	}

	.mobile-menu-toggle.active span:nth-child(3) {
		transform: rotate(-45deg) translate(8px, -8px);
	}

	/* Mobile Navigation Overlay */
	.mobile-nav-overlay {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100vh;
		background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
		z-index: 100;
		opacity: 0;
		visibility: hidden;
		transition: opacity 0.3s ease, visibility 0.3s ease;
	}

	.mobile-nav-overlay.active {
		opacity: 1;
		visibility: visible;
	}

	.mobile-nav-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100%;
		gap: 2rem;
		padding: 2rem;
	}

	.mobile-nav-link {
		font-family: "Segoe UI", Tahoma, Arial, sans-serif;
		direction: rtl;
		color: white;
		text-decoration: none;
		font-weight: 600;
		font-size: 1.5rem;
		padding: 1rem 2rem;
		border-radius: 0.5rem;
		transition: all 0.3s ease;
		text-align: center;
		width: 100%;
		max-width: 300px;
	}

	.mobile-nav-link:hover {
		background: rgba(255, 255, 255, 0.25);
		transform: scale(1.05);
	}

	.mobile-nav-link-active {
		background: rgba(255, 255, 255, 0.3);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
	}

	/* Mobile Styles */
	@media (max-width: 768px) {
		.main-nav {
			padding: 1.75rem 0 !important;
			position: relative;
		}

		.desktop-nav {
			display: none;
		}

		.mobile-menu-toggle {
			display: flex;
		}

		.mobile-nav-overlay {
			display: block;
		}
	}
</style>

<script>
	// Mobile menu toggle functionality
	document.addEventListener("DOMContentLoaded", function () {
		const menuToggle = document.querySelector(".mobile-menu-toggle");
		const navOverlay = document.querySelector(".mobile-nav-overlay");
		const mobileLinks = document.querySelectorAll(".mobile-nav-link");

		if (menuToggle && navOverlay) {
			menuToggle.addEventListener("click", function () {
				menuToggle.classList.toggle("active");
				navOverlay.classList.toggle("active");
				document.body.style.overflow = navOverlay.classList.contains("active") ? "hidden" : "";
			});

			// Close menu when clicking on a link
			mobileLinks.forEach((link) => {
				link.addEventListener("click", function () {
					menuToggle.classList.remove("active");
					navOverlay.classList.remove("active");
					document.body.style.overflow = "";
				});
			});

			// Close menu when clicking outside
			navOverlay.addEventListener("click", function (e) {
				if (e.target === navOverlay) {
					menuToggle.classList.remove("active");
					navOverlay.classList.remove("active");
					document.body.style.overflow = "";
				}
			});
		}
	});
</script>
 <div class="container">
	<header>
		<h1 class="arabic-text">Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</h1>
		<p class="section-subtitle arabic-text" style="color: rgba(255, 255, 255, 0.9); margin-top: 1rem;">
			ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„ØªØ­Ø³ÙŠÙ† Ù…Ù‡Ø§Ø±Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
		</p>
	</header>

	<main id="questionContent">
		<section class="section" style="min-height: 200px;">
			<p style="text-align: center; color: #555; font-size: 1.2rem; padding: 2rem;">
				<span class="arabic-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
			</p>
		</section>
	</main>
</div>

<script>
	const QUESTION_BANK_PATH = "simple_question_bank/question_bank.json";
	let questionBank = null;
	let allQuestions = [];

	// Load question bank
	async function loadQuestionBank() {
		if (questionBank) {
			return questionBank;
		}

		try {
			const response = await fetch(QUESTION_BANK_PATH);
			if (!response.ok) {
				throw new Error(`Failed to load ${QUESTION_BANK_PATH}`);
			}
			questionBank = await response.json();
			
			// Use the flattened questions array directly
			allQuestions = questionBank.questions || [];

			console.log(`Loaded ${allQuestions.length} questions from question bank`);
			return questionBank;
		} catch (error) {
			console.error("Error loading question bank:", error);
			document.getElementById("questionContent").innerHTML = 
				'<section class="section"><p style="color: #ff6b6b; text-align: center;">Error loading questions. Please ensure the file exists.</p></section>';
			return null;
		}
	}

	// Get a random question
	function getRandomQuestion() {
		if (allQuestions.length === 0) {
			return null;
		}
		const randomIndex = Math.floor(Math.random() * allQuestions.length);
		return allQuestions[randomIndex];
	}

	// Toggle Arabic translation display
	function toggleArabicTranslation() {
		const arabicDiv = document.getElementById('question-arabic');
		const infoButton = document.getElementById('info-button');
		if (arabicDiv && infoButton) {
			if (arabicDiv.style.maxHeight && arabicDiv.style.maxHeight !== '0px') {
				// Collapse
				arabicDiv.style.maxHeight = '0px';
				arabicDiv.style.opacity = '0';
				infoButton.classList.remove('active');
			} else {
				// Expand - temporarily set to auto to get the actual height
				arabicDiv.style.maxHeight = 'none';
				const height = arabicDiv.scrollHeight;
				arabicDiv.style.maxHeight = '0px';
				// Force reflow
				void arabicDiv.offsetHeight;
				// Now animate to the actual height
				arabicDiv.style.maxHeight = height + 'px';
				arabicDiv.style.opacity = '1';
				infoButton.classList.add('active');
			}
		}
	}

	// Display a random question
	function displayQuestion(question) {
		const content = document.getElementById("questionContent");
		const html = `
			<section class="section">
				<div class="question-item" style="text-align: center; padding: 3rem 2rem; position: relative;">
					<button class="tts-button" onclick="speakText('${question.english.replace(/'/g, "\\'")}', this)" title="Read aloud" style="position: absolute; top: 1rem; right: 1rem;">ğŸ”Š</button>
					<button id="info-button" class="info-button" onclick="toggleArabicTranslation()" title="Show Arabic translation" style="position: absolute; top: 1rem; left: 1rem;">â„¹ï¸</button>
					<p class="question-text" style="font-size: clamp(1.5rem, 3vw, 2.5rem); margin: 0; color: #1e3c72; font-weight: 600;">
						${question.english}
					</p>
					<div id="question-arabic" class="arabic-translation" style="max-height: 0; opacity: 0; overflow: hidden; transition: max-height 0.3s ease, opacity 0.3s ease; margin-top: 1.5rem;">
						<p class="arabic-text" style="font-size: clamp(1.2rem, 2.5vw, 1.8rem); margin: 0; color: #2a5298; font-weight: 600; direction: rtl; text-align: center;">
							${question.arabic.replace(/'/g, "\\'")}
						</p>
					</div>
				</div>
			</section>
			<div style="text-align: center; margin-top: 2rem;">
				<button class="random-button" id="randomQuestionButton" onclick="loadRandomQuestion()">
					<span class="arabic-text">Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</span>
				</button>
			</div>
		`;
		content.innerHTML = html;
	}

	// Make function globally accessible
	window.toggleArabicTranslation = toggleArabicTranslation;

	// Load and display a random question
	async function loadRandomQuestion() {
		await loadQuestionBank();
		if (allQuestions.length === 0) {
			return;
		}
		const question = getRandomQuestion();
		if (question) {
			displayQuestion(question);
		}
	}

	// Make function globally accessible
	window.loadRandomQuestion = loadRandomQuestion;

	// Load initial question on page load
	(async function() {
		await loadQuestionBank();
		if (allQuestions.length > 0) {
			loadRandomQuestion();
		}
	})();

	// TTS functionality (reuse from main page if available, otherwise define it)
	if (typeof speakText === 'undefined') {
		let currentUtterance = null;
		let currentButton = null;

		window.speakText = function(text, buttonElement) {
			// Stop any currently playing speech
			if (window.speechSynthesis.speaking) {
				window.speechSynthesis.cancel();
				if (currentButton) {
					currentButton.classList.remove("playing");
				}
			}

			// Create new utterance
			const utterance = new SpeechSynthesisUtterance(text);
			utterance.lang = "en-US";
			utterance.rate = 0.9;
			utterance.pitch = 1;
			utterance.volume = 1;

			// Try to use a high-quality female voice if available
			function setVoice() {
				const voices = window.speechSynthesis.getVoices();
				const femaleVoiceNames = ["Samantha", "Victoria", "Karen", "Fiona", "Tessa", "Zira", "Hazel", "Susan", "Linda", "Female", "Google UK English Female", "Microsoft Zira"];
				const preferredFemaleVoices = voices.filter(
					(voice) => voice.lang.startsWith("en") && femaleVoiceNames.some((name) => voice.name.includes(name))
				);

				if (preferredFemaleVoices.length > 0) {
					utterance.voice = preferredFemaleVoices[0];
				} else {
					const englishVoices = voices.filter((voice) => voice.lang.startsWith("en"));
					if (englishVoices.length > 0) {
						utterance.voice = englishVoices[0];
					}
				}
			}

			setVoice();
			if (window.speechSynthesis.getVoices().length === 0) {
				window.speechSynthesis.onvoiceschanged = setVoice;
			}

			currentButton = buttonElement || (window.event ? window.event.target : null);

			if (currentButton) {
				currentButton.classList.add("playing");
			}

			utterance.onend = function() {
				if (currentButton) {
					currentButton.classList.remove("playing");
				}
				currentUtterance = null;
				currentButton = null;
			};

			utterance.onerror = function() {
				if (currentButton) {
					currentButton.classList.remove("playing");
				}
				currentUtterance = null;
				currentButton = null;
			};

			currentUtterance = utterance;
			window.speechSynthesis.speak(utterance);
		};
	}
</script>

<style>
	.info-button {
		background: rgba(74, 144, 226, 0.2);
		border: 2px solid #4a90e2;
		border-radius: 50%;
		width: 2.5rem;
		height: 2.5rem;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		font-size: 1.2rem;
		transition: all 0.3s ease;
		padding: 0;
	}

	.info-button:hover {
		background: rgba(74, 144, 226, 0.3);
		transform: scale(1.1);
		box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
	}

	.info-button.active {
		background: rgba(74, 144, 226, 0.4);
		border-color: #357abd;
	}

	.arabic-translation {
		border-top: 2px solid rgba(74, 144, 226, 0.2);
		padding-top: 1.5rem;
	}

	@media (max-width: 768px) {
		.info-button {
			width: 2rem;
			height: 2rem;
			font-size: 1rem;
		}
	}
</style>

 <script>
	// Cache for available papers
	let availablePapers = [];
	const PAST_PAPERS_DIR = "past_papers/";

	// Function to load the papers index
	async function loadPapersIndex() {
		if (availablePapers.length > 0) {
			return availablePapers; // Already loaded
		}

		try {
			// Try to load index.json from root directory first (where it actually exists)
			const rootResponse = await fetch("index.json");
			if (rootResponse.ok) {
				const index = await rootResponse.json();
				if (Array.isArray(index)) {
					availablePapers = index.map((file) =>
						file.startsWith(PAST_PAPERS_DIR) ? file : `${PAST_PAPERS_DIR}${file}`
					);
				} else if (index.papers && Array.isArray(index.papers)) {
					availablePapers = index.papers.map((file) =>
						file.startsWith(PAST_PAPERS_DIR) ? file : `${PAST_PAPERS_DIR}${file}`
					);
				}
			} else {
				// Fallback: try past_papers directory (in case it exists there)
				const indexPath = `${PAST_PAPERS_DIR}index.json`;
				const response = await fetch(indexPath);
				if (response.ok) {
					const index = await response.json();
					if (Array.isArray(index)) {
						availablePapers = index.map((file) =>
							file.startsWith(PAST_PAPERS_DIR) ? file : `${PAST_PAPERS_DIR}${file}`
						);
					} else if (index.papers && Array.isArray(index.papers)) {
						availablePapers = index.papers.map((file) =>
							file.startsWith(PAST_PAPERS_DIR) ? file : `${PAST_PAPERS_DIR}${file}`
						);
					}
				} else {
					throw new Error("No index.json found");
				}
			}

			console.log(`Loaded ${availablePapers.length} papers from index`);
			return availablePapers;
		} catch (error) {
			console.error("Error loading papers index:", error);
			// Fallback: try pattern-based discovery
			return await discoverPapersByPattern();
		}
	}

	// Fallback: discover papers by trying common patterns
	async function discoverPapersByPattern() {
		const discovered = [];
		const promises = [];

		// Try papers from 001 to 100
		for (let i = 1; i <= 100; i++) {
			const num = i.toString().padStart(3, "0");
			const filename = `${PAST_PAPERS_DIR}a1_paper_${num}.json`;

			promises.push(
				fetch(filename, { method: "HEAD" })
					.then((response) => {
						if (response.ok) {
							discovered.push(filename);
						}
					})
					.catch(() => {})
			);
		}

		await Promise.allSettled(promises);
		availablePapers = discovered.sort();
		console.log(`Discovered ${availablePapers.length} papers by pattern`);
		return availablePapers;
	}

	// Function to get a random paper filename
	function getRandomPaper() {
		if (availablePapers.length === 0) {
			return `${PAST_PAPERS_DIR}a1_paper_001.json`; // fallback
		}
		const randomIndex = Math.floor(Math.random() * availablePapers.length);
		return availablePapers[randomIndex];
	}

	// Cache for available images
	let availableImages = [];

	// Function to load images index
	async function loadImagesIndex() {
		if (availableImages.length > 0) {
			return availableImages; // Already loaded
		}

		const IMAGES_DIR = "past_papers_images/";

		try {
			// Try to load index.json from images directory
			const indexPath = `${IMAGES_DIR}index.json`;
			const response = await fetch(indexPath);
			if (response.ok) {
				const index = await response.json();
				if (Array.isArray(index)) {
					availableImages = index.map((file) =>
						file.endsWith(".png") ? `${IMAGES_DIR}${file}` : `${IMAGES_DIR}${file}.png`
					);
				} else if (index.images && Array.isArray(index.images)) {
					availableImages = index.images.map((file) =>
						file.endsWith(".png") ? `${IMAGES_DIR}${file}` : `${IMAGES_DIR}${file}.png`
					);
				}
				console.log(`Loaded ${availableImages.length} images from index`);
				return availableImages;
			}
		} catch (error) {
			console.log("No images index.json found, will discover images");
		}

		// Fallback: discover images by trying common patterns
		return await discoverImagesByPattern();
	}

	// Fallback: discover images by trying common patterns
	async function discoverImagesByPattern() {
		const IMAGES_DIR = "past_papers_images/";
		const discovered = [];
		const promises = [];

		// Try common naming patterns
		const patterns = [
			// Try numbered patterns: image_01.png, image_1.png, img_01.png, etc.
			...Array.from({ length: 20 }, (_, i) => {
				const num = (i + 1).toString().padStart(2, "0");
				return [
					`${IMAGES_DIR}image_${num}.png`,
					`${IMAGES_DIR}img_${num}.png`,
					`${IMAGES_DIR}${num}.png`,
				];
			}).flat(),
			// Try single digits
			...Array.from({ length: 10 }, (_, i) => `${IMAGES_DIR}image_${i + 1}.png`),
		];

		// Remove duplicates
		const uniquePatterns = [...new Set(patterns)];

		for (const filename of uniquePatterns) {
			promises.push(
				fetch(filename, { method: "HEAD" })
					.then((response) => {
						if (response.ok) {
							discovered.push(filename);
						}
					})
					.catch(() => {})
			);
		}

		await Promise.allSettled(promises);
		availableImages = discovered.sort();
		console.log(`Discovered ${availableImages.length} images by pattern`);
		return availableImages;
	}

	// Function to get a random image from past_papers_images directory
	async function getRandomImage() {
		// Ensure images are loaded
		if (availableImages.length === 0) {
			await loadImagesIndex();
		}

		if (availableImages.length === 0) {
			// No images found, return null to hide the image section
			return null;
		}

		const randomIndex = Math.floor(Math.random() * availableImages.length);
		return availableImages[randomIndex];
	}

	// Timer functionality (defined early so it can be used by loadPaper)
	const timers = {
		personal: { interval: null, remaining: 90, total: 90, running: false },
		situations: { interval: null, remaining: 90, total: 90, running: false },
		image: { interval: null, remaining: 90, total: 90, running: false },
		listening: { interval: null, remaining: 120, total: 120, running: false },
		monologue: { interval: null, remaining: 120, total: 120, running: false },
	};

	function formatTime(seconds) {
		const mins = Math.floor(seconds / 60);
		const secs = seconds % 60;
		return `${mins}:${secs.toString().padStart(2, "0")}`;
	}

	function updateTimerDisplay(section) {
		const timer = timers[section];
		const display = document.getElementById(`timer-${section}`);
		const button = document.getElementById(`timer-btn-${section}`);
		if (display) {
			display.textContent = formatTime(timer.remaining);
			if (timer.running) {
				display.classList.add("timer-running");
			} else {
				display.classList.remove("timer-running");
			}
		}
		if (button) {
			button.textContent = timer.running ? "â¸" : "â–¶";
		}
	}

	function resetAllTimers() {
		Object.keys(timers).forEach((section) => {
			const timer = timers[section];
			if (timer.interval) {
				clearInterval(timer.interval);
			}
			timer.remaining = timer.total;
			timer.running = false;
			updateTimerDisplay(section);
		});
	}

	// Function to load a specific paper
	function loadPaper(filename) {
		// Reset all timers when loading new paper
		resetAllTimers();

		document.getElementById("content").innerHTML =
			'<p style="text-align: center; color: white; font-size: 1.2rem;">Loading content...</p>';

		fetch(filename)
			.then((response) => {
				if (!response.ok) {
					throw new Error(`Failed to load ${filename}`);
				}
				return response.json();
			})
			.then((data) => {
				displayContent(data);
				document.getElementById("currentPaper").textContent = `Current: ${data.id || filename}`;
			})
			.catch((error) => {
				document.getElementById(
					"content"
				).innerHTML = `<p style="color: #ff6b6b; text-align: center;">Error loading ${filename}. Please ensure the file exists.</p>`;
				console.error("Error:", error);
				document.getElementById("currentPaper").textContent = "";
			});
	}

	// Function to load a random paper
	async function loadRandomPaper() {
		// Ensure papers are loaded
		if (availablePapers.length === 0) {
			document.getElementById("content").innerHTML =
				'<p style="text-align: center; color: white; font-size: 1.2rem;">Loading available papers...</p>';
			await loadPapersIndex();
		}

		const currentPaper = document.getElementById("currentPaper").textContent;
		let randomPaper;

		// If there's only one paper, just reload it
		if (availablePapers.length <= 1) {
			randomPaper = availablePapers[0] || `${PAST_PAPERS_DIR}a1_paper_001.json`;
		} else {
			// Get a different random paper (avoid loading the same one if possible)
			do {
				randomPaper = getRandomPaper();
			} while (
				availablePapers.length > 1 &&
				currentPaper.includes(randomPaper.replace(".json", "").replace(PAST_PAPERS_DIR, ""))
			);
		}

		// Scroll to top and load the paper
		window.scrollTo({ top: 0, behavior: "smooth" });
		loadPaper(randomPaper);
	}

	// Make function globally accessible
	window.loadRandomPaper = loadRandomPaper;

	// Load initial paper on page load
	(async function () {
		await loadPapersIndex();
		if (availablePapers.length > 0) {
			loadPaper(availablePapers[0]);
		} else {
			// Fallback if no papers found
			loadPaper(`${PAST_PAPERS_DIR}a1_paper_001.json`);
		}
	})();

	// Also attach event listener as backup (in addition to onclick)
	document.addEventListener("DOMContentLoaded", function () {
		const button = document.getElementById("randomButton");
		if (button) {
			button.addEventListener("click", function (e) {
				e.preventDefault();
				loadRandomPaper();
			});
		}
	});

	function displayContent(data) {
		const content = document.getElementById("content");
		let html = "";

		// Personal Information Section
		html += `
                <section class="section">
                    <h2>
                        <span class="arabic-text">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</span>
                        <span class="section-timestamp">
                            <button class="timer-button" onclick="toggleTimer('personal', 90)" id="timer-btn-personal">â–¶</button>
                            <span class="timer-display" id="timer-personal">1:30</span>
                        </span>
                    </h2>
                    <p class="section-subtitle arabic-text">Ø£Ø³Ø¦Ù„Ø© ØªÙ…Ù‡ÙŠØ¯ÙŠØ© ÙˆØ¹Ø§Ù…Ø© Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø´Ø­</p>
                    
                    <h3 class="subsection-title arabic-text">Ø£Ø³Ø¦Ù„Ø© ØªÙ…Ù‡ÙŠØ¯ÙŠØ©</h3>
                    <p class="subsection-subtitle arabic-text">Ø£Ø³Ø¦Ù„Ø© Ø¹Ø§Ù…Ø© Ø¹Ù†Ùƒ.</p>
                    ${data.personal_information.intro_questions
											.map(
												(q) => `
                        <div class="question-item">
                            <button class="tts-button" onclick="speakText('${q.text.replace(
															/'/g,
															"\\'"
														)}', this)" title="Read aloud">ğŸ”Š</button>
                            <p class="question-text">${q.text}</p>
                        </div>
                    `
											)
											.join("")}
                    
                    <h3 class="subsection-title arabic-text">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
                    <p class="subsection-subtitle arabic-text">Ø£Ø³Ø¦Ù„Ø© Ù…Ø­Ø¯Ø¯Ø© Ø¹Ù†ÙƒØŒ Ù‡ÙˆØ§ÙŠØ§ØªÙƒØŒ ØªÙØ¶ÙŠÙ„Ø§ØªÙƒØŒ Ø¥Ù„Ø®.</p>
                    ${data.personal_information.main_questions
											.map(
												(q) => `
                        <div class="question-item">
                            <button class="tts-button" onclick="speakText('${q.text.replace(
															/'/g,
															"\\'"
														)}', this)" title="Read aloud">ğŸ”Š</button>
                            <p class="question-text">${q.text}</p>
                        </div>
                    `
											)
											.join("")}
                </section>
            `;

		// Situations Section
		html += `
                <section class="section">
                    <h2>
                        <span class="arabic-text">Ø§Ù„Ù…ÙˆØ§Ù‚Ù</span>
                        <span class="section-timestamp">
                            <button class="timer-button" onclick="toggleTimer('situations', 90)" id="timer-btn-situations">â–¶</button>
                            <span class="timer-display" id="timer-situations">1:30</span>
                        </span>
                    </h2>
                    <p class="section-subtitle arabic-text">Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ù…Ø±Ø´Ø­ Ù„Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ø£Ùˆ Ø¨Ø¯Ø¦Ù‡Ø§</p>
                    
                    <h3 class="subsection-title arabic-text">Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø±Ø¯</h3>
                    <p class="subsection-subtitle arabic-text">ÙƒÙŠÙ ØªØ±Ø¯ ÙÙŠ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©ØŸ</p>
                    ${data.situations.respond_situations
											.map(
												(s) => `
                        <div class="situation-item">
                            <button class="tts-button" onclick="speakText('${(
															s.role_context +
															" " +
															s.starter_line
														).replace(/'/g, "\\'")}', this)" title="Read aloud">ğŸ”Š</button>
                            <div class="role-context">${s.role_context}</div>
                            <p class="starter-line">"${s.starter_line}"</p>
                        </div>
                    `
											)
											.join("")}
                    
                    <h3 class="subsection-title arabic-text">Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø³Ø¤Ø§Ù„</h3>
                    <p class="subsection-subtitle arabic-text">Ù…Ø§Ø°Ø§ ØªØ³Ø£Ù„ ÙÙŠ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©ØŸ</p>
                    ${data.situations.ask_situations
											.map(
												(s) => `
                        <div class="situation-item">
                            <button class="tts-button" onclick="speakText('${s.instruction.replace(
															/'/g,
															"\\'"
														)}', this)" title="Read aloud">ğŸ”Š</button>
                            <div class="role-context">${s.instruction}</div>
                            <p class="starter-line">...?</p>
                        </div>
                    `
											)
											.join("")}
                </section>
            `;

		// Image Section (Section 3)
		html += `
                <section class="section">
                    <h2>
                        <span class="arabic-text">Ø§Ù„ØµÙˆØ±Ø©</span>
                        <span class="section-timestamp">
                            <button class="timer-button" onclick="toggleTimer('image', 90)" id="timer-btn-image">â–¶</button>
                            <span class="timer-display" id="timer-image">1:30</span>
                        </span>
                    </h2>
                    <p class="section-subtitle arabic-text">Ø³ÙŠØ·Ø±Ø­ Ø§Ù„Ù…Ù…ØªØ­Ù† Ø£Ø³Ø¦Ù„Ø© Ø­ÙˆÙ„ Ø§Ù„ØµÙˆØ±Ø©ØŒ ÙˆÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø±Ø´Ø­ Ø£ÙŠØ¶Ø§Ù‹ Ø§Ù‚ØªØ±Ø§Ø­ Ø£Ø³Ø¦Ù„Ø©</p>
                    <div class="exam-image-container">
                        <img id="exam-image" src="" alt="Exam image" class="exam-image" />
                    </div>
                </section>
            `;

		// Listening Script Section (Section 4)
		html += `
                <section class="section">
                    <h2>
                        <span class="arabic-text">Ù†Øµ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹</span>
                        <span class="section-timestamp">
                            <button class="timer-button" onclick="toggleTimer('listening', 120)" id="timer-btn-listening">â–¶</button>
                            <span class="timer-display" id="timer-listening">2:00</span>
                        </span>
                    </h2>
                    <p class="section-subtitle arabic-text">Ù†Øµ Ù‚ØµÙŠØ± Ù…ØªØ¨ÙˆØ¹ Ø¨Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ÙÙ‡Ù…</p>
                    
                    <div class="listening-text" style="position: relative;">
                        <button class="tts-button" onclick="speakText('${data.listening_script.text.replace(
													/'/g,
													"\\'"
												)}', this)" title="Read aloud" style="position: absolute; top: 1rem; right: 1rem;">ğŸ”Š</button>
                        ${data.listening_script.text}
                    </div>
                    
                    <h3 class="subsection-title arabic-text">Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
                    <p class="subsection-subtitle arabic-text">Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ Ø£Ø¹Ù„Ø§Ù‡.</p>
                    ${data.listening_script.questions
											.map(
												(q) => `
                        <div class="question-answer" style="position: relative;">
                            <button class="tts-button" onclick="speakText('${q.question.replace(
															/'/g,
															"\\'"
														)}', this)" title="Read aloud" style="position: absolute; top: 0.75rem; right: 0.75rem;">ğŸ”Š</button>
                            <p class="question-text">${q.question}</p>
                        </div>
                    `
											)
											.join("")}
                </section>
            `;

		// Monologue Section (Section 5)
		html += `
                <section class="section">
                    <h2>
                        <span class="arabic-text">Ø§Ù„Ø­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ÙØ±Ø¯</span>
                        <span class="section-timestamp">
                            <button class="timer-button" onclick="toggleTimer('monologue', 120)" id="timer-btn-monologue">â–¶</button>
                            <span class="timer-display" id="timer-monologue">2:00</span>
                        </span>
                    </h2>
                    <p class="section-subtitle arabic-text">Ù…ÙˆØ¶ÙˆØ¹ Ù„Ù„Ù…Ø±Ø´Ø­ Ù„Ù„ØªØ­Ø¯Ø« Ø¹Ù†Ù‡ØŒ Ù…Ø¹ Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ§Ø¨Ø¹Ø©</p>
                    
                    <div class="monologue-topic" style="position: relative;">
                        <button class="tts-button" onclick="speakText('${(
													data.monologue.topic + " for 30 seconds"
												).replace(
													/'/g,
													"\\'"
												)}', this)" title="Read aloud" style="position: absolute; top: 1rem; right: 1rem; background: rgba(255, 255, 255, 0.3); border-color: white;">ğŸ”Š</button>
                        ${data.monologue.topic} for 30 seconds
                    </div>
                    
                    <h3 class="subsection-title arabic-text">Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</h3>
                    <p class="subsection-subtitle arabic-text">ÙƒÙ† Ù…Ø³ØªØ¹Ø¯Ù‹Ø§ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø­ÙˆÙ„ Ù…ÙˆØ¶ÙˆØ¹Ùƒ.</p>
                    ${data.monologue.follow_up_questions
											.map(
												(q) => `
                        <div class="question-item">
                            <button class="tts-button" onclick="speakText('${q.question.replace(
															/'/g,
															"\\'"
														)}')" title="Read aloud">ğŸ”Š</button>
                            <p class="question-text">${q.question}</p>
                        </div>
                    `
											)
											.join("")}
                </section>
            `;

		content.innerHTML = html;

		// Load random image after content is rendered
		getRandomImage()
			.then((imagePath) => {
				const imgElement = document.getElementById("exam-image");
				if (imgElement && imagePath) {
					imgElement.src = imagePath;
					// Remove error handler to prevent infinite retry loop
					// If image fails, it will just not display (better than spamming errors)
					imgElement.onerror = function () {
						// Hide the image container if image fails to load
						const container = this.closest(".exam-image-container");
						if (container) {
							container.style.display = "none";
						}
					};
				} else if (imgElement) {
					// No images found, hide the image container
					const container = imgElement.closest(".exam-image-container");
					if (container) {
						container.style.display = "none";
					}
				}
			})
			.catch((error) => {
				console.error("Error loading image:", error);
				const imgElement = document.getElementById("exam-image");
				if (imgElement) {
					const container = imgElement.closest(".exam-image-container");
					if (container) {
						container.style.display = "none";
					}
				}
			});
	}

	// TTS functionality using Web Speech API
	let currentUtterance = null;
	let currentButton = null;

	function speakText(text, buttonElement) {
		// Stop any currently playing speech
		if (window.speechSynthesis.speaking) {
			window.speechSynthesis.cancel();
			if (currentButton) {
				currentButton.classList.remove("playing");
			}
		}

		// Create new utterance
		const utterance = new SpeechSynthesisUtterance(text);

		// Configure voice settings for quality English TTS
		utterance.lang = "en-US";
		utterance.rate = 0.9; // Slightly slower for clarity
		utterance.pitch = 1;
		utterance.volume = 1;

		// Try to use a high-quality female voice if available
		function setVoice() {
			const voices = window.speechSynthesis.getVoices();

			// Prefer female voices - common female voice names
			const femaleVoiceNames = [
				"Samantha",
				"Victoria",
				"Karen",
				"Fiona",
				"Tessa",
				"Zira",
				"Hazel",
				"Susan",
				"Linda",
				"Female",
				"Google UK English Female",
				"Microsoft Zira",
			];

			// First try to find a preferred female voice
			const preferredFemaleVoices = voices.filter(
				(voice) =>
					voice.lang.startsWith("en") && femaleVoiceNames.some((name) => voice.name.includes(name))
			);

			if (preferredFemaleVoices.length > 0) {
				utterance.voice = preferredFemaleVoices[0];
			} else {
				// Try any female voice (check if voice name suggests female)
				const anyFemaleVoices = voices.filter(
					(voice) =>
						voice.lang.startsWith("en") &&
						(voice.name.toLowerCase().includes("female") ||
							voice.name.toLowerCase().includes("samantha") ||
							voice.name.toLowerCase().includes("zira") ||
							voice.name.toLowerCase().includes("victoria") ||
							voice.name.toLowerCase().includes("karen"))
				);

				if (anyFemaleVoices.length > 0) {
					utterance.voice = anyFemaleVoices[0];
				} else {
					// Fallback to any high-quality voice
					const preferredVoices = voices.filter(
						(voice) =>
							voice.lang.startsWith("en") &&
							(voice.name.includes("Google") ||
								voice.name.includes("Microsoft") ||
								voice.name.includes("Samantha") ||
								voice.name.includes("Alex"))
					);

					if (preferredVoices.length > 0) {
						utterance.voice = preferredVoices[0];
					} else {
						// Final fallback to first English voice
						const englishVoices = voices.filter((voice) => voice.lang.startsWith("en"));
						if (englishVoices.length > 0) {
							utterance.voice = englishVoices[0];
						}
					}
				}
			}
		}

		// Set voice (may need to wait for voices to load)
		setVoice();
		if (window.speechSynthesis.getVoices().length === 0) {
			window.speechSynthesis.onvoiceschanged = setVoice;
		}

		// Get button element from event
		currentButton = buttonElement || (window.event ? window.event.target : null);

		// Add visual feedback
		if (currentButton) {
			currentButton.classList.add("playing");
		}

		// Handle speech end
		utterance.onend = function () {
			if (currentButton) {
				currentButton.classList.remove("playing");
			}
			currentUtterance = null;
			currentButton = null;
		};

		utterance.onerror = function () {
			if (currentButton) {
				currentButton.classList.remove("playing");
			}
			currentUtterance = null;
			currentButton = null;
		};

		currentUtterance = utterance;
		window.speechSynthesis.speak(utterance);
	}

	// Load voices when available (some browsers need this)
	if (window.speechSynthesis.onvoiceschanged !== undefined) {
		window.speechSynthesis.onvoiceschanged = function () {
			// Voices loaded
		};
	}

	function toggleTimer(section, totalSeconds) {
		const timer = timers[section];
		const button = event.target;

		if (timer.running) {
			// Pause
			clearInterval(timer.interval);
			timer.running = false;
			button.textContent = "â–¶";
			button.title = "Resume timer";
		} else {
			// Start/Resume
			timer.running = true;
			button.textContent = "â¸";
			button.title = "Pause timer";

			timer.interval = setInterval(() => {
				timer.remaining--;
				updateTimerDisplay(section);

				// Stop when reaching 0
				if (timer.remaining <= 0) {
					clearInterval(timer.interval);
					timer.running = false;
					timer.remaining = 0;
					button.textContent = "â–¶";
					button.title = "Start timer";
					updateTimerDisplay(section);

					// Optional: Play a sound or show notification
					if (window.speechSynthesis) {
						const utterance = new SpeechSynthesisUtterance("Time is up");
						utterance.volume = 0.5;
						window.speechSynthesis.speak(utterance);
					}
				}
			}, 1000);
		}

		updateTimerDisplay(section);
	}
</script>

	</body>
</html>
